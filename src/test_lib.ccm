module;

#include <format>
#include <iostream>

export module test_lib;
export import :randomizer;
export import :data;
export import :exception;
export import :container;
export import :assert;
export import :tester;

namespace test_lib {
  export template <size_t size, TesterC<size> T>
  void print_result(
    const T &tester,
    const std::array<TestResult, size> &results,
    std::ostream &os = std::cout
  ) {
    std::cout << "================== Test Result =====================\n";
    std::cout << "Test Suite : " << tester.get_test_name() << std::endl;
    std::cout << "Run type : "
              << (tester.is_parallel() ? "parallel" : "one-by-one")
              << std::endl;
    std::cout << "Number of test : " << T::test_count() << std::endl;
    std::cout << "================== Test Report =====================\n";
    size_t i = 0;
    for (const auto &result : results) {
      std::cout << std::format(
        "{}. {}\n{}", i + 1, result.test_name, result.get_print_result()
      );
    }
  }
}